# DuckCode Enterprise Security Configuration Template
# Copy this to .env and fill in your values

# ============================================
# JWT Configuration (CRITICAL)
# ============================================
# Generate with: openssl rand -base64 32
JWT_SECRET=REPLACE_WITH_SECURE_256_BIT_SECRET

# ============================================
# Supabase Configuration
# ============================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_SCHEMA=duckcode

# ============================================
# Frontend Configuration
# ============================================
FRONTEND_URL=http://localhost:5175

# ============================================
# Rate Limiting Configuration
# ============================================
RATE_LIMIT_ENABLED=true

# Authentication endpoints (login, register)
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_AUTH_WINDOW_MS=900000

# Registration endpoint
RATE_LIMIT_REGISTRATION_MAX=3
RATE_LIMIT_REGISTRATION_WINDOW_MS=3600000

# IDE token exchange
RATE_LIMIT_IDE_TOKEN_MAX=10
RATE_LIMIT_IDE_TOKEN_WINDOW_MS=900000

# General API endpoints
RATE_LIMIT_API_MAX=100
RATE_LIMIT_API_WINDOW_MS=900000

# Password reset
RATE_LIMIT_PASSWORD_RESET_MAX=3
RATE_LIMIT_PASSWORD_RESET_WINDOW_MS=3600000

# ============================================
# Account Lockout Configuration
# ============================================
LOCKOUT_ENABLED=true
LOCKOUT_MAX_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30
LOCKOUT_TRACKING_WINDOW_MINUTES=15

# ============================================
# Password Policy Configuration
# ============================================
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_PREVENT_COMMON=true
PASSWORD_PREVENT_USER_INFO=true

# ============================================
# Session Management Configuration
# ============================================
SESSION_WEB_EXPIRY_DAYS=30
SESSION_IDE_EXPIRY_DAYS=7
SESSION_INVALIDATE_ON_PASSWORD_CHANGE=true
SESSION_MAX_CONCURRENT=5
SESSION_REFRESH_TOKEN_ROTATION=true

# ============================================
# Security Audit Logging Configuration
# ============================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_LOG_LEVEL=all

# ============================================
# Email Configuration (for verification)
# ============================================
EMAIL_VERIFICATION_REQUIRED=true
EMAIL_FROM=noreply@duckcode.dev
EMAIL_PROVIDER=supabase

# ============================================
# Security Monitoring Configuration
# ============================================
SECURITY_MONITORING_ENABLED=true
SECURITY_ALERT_EMAIL=security@duckcode.dev
SUSPICIOUS_ACTIVITY_THRESHOLD=5

# ============================================
# Compliance Configuration
# ============================================
COMPLIANCE_MODE=enterprise
DATA_RETENTION_DAYS=365
EXPORT_ENABLED=true

# ============================================
# Production Settings
# ============================================
NODE_ENV=production
PORT=3001
LOG_LEVEL=info
